javascript:(function(){"use strict";if(document.getElementById("toc-panel")||document.getElementById("toc-handle")) return;let previewLength = 80;const style=document.createElement("style");style.textContent=`#toc-panel{position:fixed;top:0;right:0;width:300px;height:100%;background:#fafafa;box-shadow:-4px 0 8px rgba(0,0,0,.1);font-family:sans-serif;font-size:.8rem;border-left:1px solid #ddd;display:flex;flex-direction:column;z-index:9998;transform:translateX(0);transition:transform .3s ease}#toc-panel.collapsed{transform:translateX(300px)}#toc-header{padding:6px 10px;background:#ddd;border-bottom:1px solid #ccc;font-weight:bold;flex-shrink:0;display:flex;justify-content:space-between;align-items:center}#toc-controls button{margin-left:4px;font-size:0.9rem;padding:2px 6px;cursor:pointer}#toc-list{list-style:none;flex:1;overflow-y:auto;margin:0;padding:6px}#toc-list li{padding:4px;cursor:pointer;border-radius:3px;transition:background-color .2s}#toc-list li:hover{background:#f0f0f0}#toc-handle{position:fixed;top:50%;right:0;transform:translateY(-50%);width:30px;height:80px;background:#ccc;display:flex;align-items:center;justify-content:center;writing-mode:vertical-rl;text-orientation:mixed;cursor:pointer;font-weight:bold;user-select:none;z-index:9999;transition:background .2s}#toc-handle:hover{background:#bbb}@media (prefers-color-scheme:dark){  #toc-panel{background:#333;border-left:1px solid #555;box-shadow:-4px 0 8px rgba(0,0,0,.7)}  #toc-header{background:#555;border-bottom:1px solid #666;color:#eee}  #toc-list li:hover{background:#444}  #toc-list{color:#eee}  #toc-handle{background:#555;color:#ddd}  #toc-handle:hover{background:#666}}%60;document.head.appendChild(style);const tocPanel=document.createElement("div");tocPanel.id="toc-panel";tocPanel.innerHTML=%60  <div id="toc-header">    <span>Conversation TOC</span>    <span id="toc-controls">      <button id="decLen">↓</button>      <button id="incLen">↑</button>    </span>  </div>  <ul id="toc-list"></ul>%60;document.body.appendChild(tocPanel);const tocHandle=document.createElement("div");tocHandle.id="toc-handle";tocHandle.textContent="TOC";document.body.appendChild(tocHandle);let root=null, observer=null, isWaiting=false, debounceTimer=null;function debounceUpdateTOC(){  if(isWaiting) return;  isWaiting=true;  debounceTimer=setTimeout(()=>{    generateTOC();    isWaiting=false;  },300);}function generateTOC(){  const tocList=document.getElementById("toc-list");  if(!tocList) return;  tocList.innerHTML="";  const turns=(root||document).querySelectorAll("article[data-testid^='conversation-turn-']");  if(!turns||turns.length===0){    tocList.innerHTML='<li style="opacity:0.7;font-style:italic;">Empty chat</li>';    return;  }  for(let i=0;i<turns.length;i++){    const turn=turns[i];    const li=document.createElement("li");    const label = i % 2 === 0 ? "You" : "AI";    const content=turn.querySelector("p, div");    let preview = "No content";    if(content){      preview=(content.textContent||"").trim().replace(/\s+/g," ").substring(0, previewLength);    }    li.textContent=%60Turn ${i+1} (${label}): ${preview}...%60;    li.addEventListener("click",()=>turn.scrollIntoView({behavior:"smooth",block:"start"}));    tocList.appendChild(li);  }}function initTOC(){  const main=document.querySelector("main#main")||document.querySelector(".chat-container")||null;  if(main!==root){    root=main;    if(observer) observer.disconnect();    if(root){      observer=new MutationObserver(()=>debounceUpdateTOC());      observer.observe(root,{childList:true,subtree:true});      generateTOC();    }  }}document.getElementById("decLen").addEventListener("click",()=>{  previewLength = Math.max(10, previewLength - 20);  generateTOC();});document.getElementById("incLen").addEventListener("click",()=>{  previewLength = Math.min(500, previewLength + 20);  generateTOC();});initTOC();setInterval(initTOC,2000);tocHandle.addEventListener("click",()=>tocPanel.classList.toggle("collapsed"));})();